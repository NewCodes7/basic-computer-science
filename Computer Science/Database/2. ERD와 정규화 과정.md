# ERD와 정규화 과정

<!-- TOC -->

- [ERD와 정규화 과정](#erd와-정규화-과정)
  - [핵심 용어](#핵심-용어)
  - [데이터베이스 설계](#데이터베이스-설계)
  - [ERD (Entity Relationship Diagram)](#erd-entity-relationship-diagram)
  - [정규화 과정](#정규화-과정)
    - [데이터베이스 이상 현상 (예시)](#데이터베이스-이상-현상-예시)
    - [정규형(NF, Normal Form) 과정 종류](#정규형nf-normal-form-과정-종류)
    - [정규형 원칙](#정규형-원칙)
    - [제1 정규형 (1NF)](#제1-정규형-1nf)
    - [제2 정규형 (2NF)](#제2-정규형-2nf)
    - [제3 정규형 (3NF)](#제3-정규형-3nf)
    - [보이스/코드 정규형 (BCNF)](#보이스코드-정규형-bcnf)
  - [레퍼런스](#레퍼런스)

<!-- /TOC -->

## 핵심 용어

- `ERD(Entity Relationship Diagram)` : **릴레이션 간의 관계**들을 정의한 것으로 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할
- `정규화` : 관계형 데이터 모델에서 **데이터의 중복성을 제거**하여 **이상 현상(Anomaly)을 방지**하고, **데이터의 일관성과 정확성**을 유지하기 위해 무손실 분해하는 과정

## 데이터베이스 설계

<img width="500" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/3762dd2d-fc08-4c60-bfcd-ae67622bdaa4">

## ERD (Entity Relationship Diagram)

<img width="500" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/f4b663f4-beaa-4dac-8bc1-628a787e0aa8">

- 의미: **릴레이션 간의 관계**들을 정의한 것으로 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할
    - 데이터 모델링 중 **논리적 데이터 모델링**에 해당합니다.
- ERD의 쓰임새
    - ERD는 **시스템 요구 사항을 기반으로** 작성된다. 그리고 해당 ERD를 기반으로 데이터베이스를 구축한다.
    - 데이터베이스를 구축한 이후에도 디버깅, 비즈니스 프로세스 재설계 등이 필요한 경우에 **설계도 역할**을 담당하기도 한다.
- 단점: 관계형 구조가 아닌 **비정형 데이터**를 충분히 표현할 수 없다.
    > **비정형 데이터**: 비구조화 데이터를 말하며, 미리 정의된 데이터 모델이 없거나 미리 정의된 방식으로 정리되지 않은 정보

## 정규화 과정

- 의미: 관계형 데이터 모델에서 **데이터의 중복성을 제거**하여 **이상 현상(Anomaly)을 방지**하고, 데이터의 일관성과 정확성을 유지하기 위해 무손실 분해하는 과정
    - 정규형 원칙을 기반으로 정규형을 만들어가는 과정
    - 릴레이션 간의 잘못된 종속 관계로 인해 데이터베이스 이상 현상 해결하는 과정
    - 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정

### 데이터베이스 이상 현상 (예시)

| STUDENT_ID | NAME | COURSE_ID | DEPARTMENT |
| --- | --- | --- | --- |
| 1 | park | 10 | 컴퓨터공학 |
| 1 | park | 11 | 컴퓨터공학 |
| 3 | kim | 13 | 전자정보 |
| 4 | lee | 13 | 수학과 |
- 삽입 이상
    - 학생 정보를 추가하고 싶은데 해당 학생이 어떠한 수업도 신청하지 않았다면 추가될 수 없습니다.
    - STUDENT_ID와 COURSE_ID가 기본키이므로 COURSE_ID는 NULL이 될수 없으므로 학생은 삽입될 수 없습니다.
    - 학생데이터가 추가되려면 "미수강"과 같은 불필요한 데이터가 함께 추가되어야만 하므로 이런 문제를 ’삽입 이상’이라고 합니다.
    - **데이터를 삽입해야 하는데 하나의 필드값이 NULL이 되면 안 되어서** 삽입하기 어려운 현상을 “삽입 이상”이라고 합니다.
- 갱신 이상
    - 학생이 개명을 하면 (학생 ID, 과목 ID)로 구분되는 개명학생의 튜플을 모두 갱신해줘야만 한다.
    - 하지만 이렇게 하지 않고, **하나의 튜플만 갱신하게 되어 생기는 문제**를 '갱신 이상’이라고 합니다.
    - 전과를 해서 학부가 변경되는 경우에도 모든 레코드를 변경하지 않으면 ‘갱신 이상’이 발생합니다.
- 삭제 이상
    - 수강 취소를 위해 수강정보만 삭제하려고 합니다.
    - 하지만 수강정보와 학생정보가 한 튜플에 들어있다면, 두 가지 정보가 함께 삭제됩니다.
    - 이렇게 하나의 튜플을 삭제하면 **삭제를 원하지 않는 데이터도 함께 삭제되는 현상**을 ’삭제 이상’이라고 합니다.

### 정규형(NF, Normal Form) 과정 종류

<img width="500" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/b629f10f-4410-4685-82be-c9174dd6439b">

- 기본 정규형
    - 제1정규형
    - 제2정규형
    - 제3정규형
    - 보이스/코드 정규형
- 고급 정규형
    - 제4정규형
    - 제5정규형

### 정규형 원칙

1. **정보 표현의 무손실**: 같은 의미를 표현하는 릴레이션이지만 좀 더 좋은 **구조**로 만들어야 합니다.
2. **데이터 중복의 최소**: 자료의 중복성은 감소해야 합니다. 
3. **분리의 원칙**: 독립적인 관계는 **별개의 릴레이션**으로 표현해야 하며, 각각의 릴레이션은 **독립적인 표현**이 가능해야 하는 것을 말합니다. 

### 제1 정규형 (1NF)

- 의미: 릴레이션의 모든 도메인이 더 이상 분해될 수 없는 **원자 값**(atomic value)만으로 구성되어 있어야 합니다.
- 조건: 한 개의 기본키에 대해 두 개 이상의 값을 가지는 반복 집합이 있어서는 안 됩니다.
- 예시
    - 원래 테이블
        
        <img width="300" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/cf2dc102-0447-4047-8783-d72d6e488249">
        
    - 제1 정규화 진행한 테이블
        
        <img width="250" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/2e1008e4-c4bc-43a7-aab9-f2c279e60d1a">
        

### 제2 정규형 (2NF)

- 의미: 제1 정규형이며 부분 함수의 종속성을 제거하여 **완전 함수 종속적인** 형태
  - 완전 함수 종속: 기본키의 부분집합이 결정자가 되어선 안된다는 것을 의미합니다.
- 주의 사항
    - 릴레이션을 분해할 때 동등한 릴레이션으로 분해해야 합니다.
    - 정보 손실이 발생하지 않는 무손실 분해로 분해되어야 합니다.
- 예시
    - 원래 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/3cf17f5c-6bf5-4d26-a2d3-ae8f012d0f9a">
        
    - 제2 정규화 진행한 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/23b9c746-f693-4055-b3ba-c2dfe41c97ca">
        

### 제3 정규형 (3NF)

- 의미: 제2 정규형이며 기본키가 아닌 모든 속성이 **이행적 함수 종속(transitive FD)이 없는** 상태
- 이행적 함수 종속: 속성이 A→B이고, B→C이면서 A→C의 관계에 있는 것
- 예시
    - 원래 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/2df12fd5-724e-47fb-9b70-dfae7b583964">
        
    - 제3 정규화 진행한 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/5f04687f-cdaf-4bb0-bf90-d3dbad9b86e5">
        

### 보이스/코드 정규형 (BCNF)

- 의미: 제3 정규화를 진행한 테이블에 대해 **모든 결정자가 후보키가 되도록** 테이블을 분해하는 것
    - 제3 정규형이고, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태
    - 결정자: 함수 종속 관계에서 특정 종속자를 결정짓는 요소, X→Y일 때 X는 결정자, Y는 종속자
- 예시
    - 원래 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/f5223d1c-9476-4a98-9ef8-52d9c06d4523">
        
    - BCNF 정규화 진행한 테이블
        
        <img width="700" alt="image" src="https://github.com/BCS-study/basic-computer-science/assets/123712285/890f871d-f6e7-4b75-add1-a38a5b065e38">
        
---

## 레퍼런스

- 이미지 출처
    - ERD: https://thebook.io/080268/0289/
    - 정규화 과정: [https://velog.io/@wisdom-one/정규화Normalization](https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization)
    - 정규화 예시: https://mangkyu.tistory.com/110
- 본문 출처
    - 정규화: [https://velog.io/@wisdom-one/정규화Normalization](https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization)
    - 데이터베이스 이상 현상: https://yunanp.tistory.com/21
